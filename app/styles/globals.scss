/* Import Tailwind directives */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Import Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Geist+Mono:wght@100..900&family=Geist:wght@100..900&family=Silkscreen:wght@400;700&display=swap');

/* Import Polymath Variable Font */
@font-face {
  font-family: 'Polymath';
  src: url('https://cdn.shopify.com/s/files/1/0614/6565/7577/files/PolymathVar.woff2?v=1748365175')
    format('woff2-variations');
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}

@mixin font-polymath($weight: 600, $serif: 100, $italic: 11) {
  font-family:
    'Polymath',
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    'Helvetica Neue',
    Arial,
    sans-serif,
    'Apple Color Emoji',
    'Segoe UI Emoji',
    'Segoe UI Symbol';
  font-variation-settings:
    'wght' #{$weight},
    'SERF' #{$serif},
    'ital' #{$italic};
}

/* Tailwind Base Layer */
@layer base {
  * {
    font-feature-settings: inherit;
  }

  html {
    font-family:
      'Geist',
      -apple-system,
      BlinkMacSystemFont,
      'Segoe UI',
      Roboto,
      'Helvetica Neue',
      Arial,
      sans-serif;
  }
}

/* Tailwind Custom Utilities */
@layer utilities {
  .bg-container {
    @apply bg-black bg-opacity-[6%];
  }

  .bg-container-alt {
    @apply bg-black bg-opacity-100;
  }

  [data-lucide] {
    @apply w-[1.1em] h-[1.1em] inline-block align-middle;
    color: currentColor;
  }

  .font-polymath-custom {
    @include font-polymath();
  }
}

/* Typography */

$hand:
  'Caveat', 'Dancing Script', Pacifico, 'Brush Script MT', 'Comic Sans MS', 'Apple Chancery',
  cursive;

.font-mono {
  font-family: 'Geist Mono', 'Space Mono', monospace;
}

/* CSS Variables for Theme System */
:root {
  /* Default theme (dark) - fallbacks */
  --theme-primary: #fbfbfb;
  --theme-secondary: #ff65d2;
  --theme-background: #00020b;
  --theme-surface: #2e2f35;
  --theme-text: #fbfbfb;
  --theme-textSecondary: #fbfbfb80;
  --theme-accent: #ff5101;
  --theme-vinyl: #1a1a1a;
  --theme-cd: #c0c0c0;
  --theme-visualizerGlow: #ff65d2;
  --theme-transitionDuration: 300ms;
  --theme-vinylSpeed: 2s;
  --theme-cdSpeed: 1s;
}

/* Theme transition class */
.theme-transitioning * {
  transition:
    background-color var(--theme-transitionDuration) ease,
    color var(--theme-transitionDuration) ease,
    border-color var(--theme-transitionDuration) ease,
    box-shadow var(--theme-transitionDuration) ease !important;
}

/* Legacy Color Palette (for backward compatibility) */
$white: #fbfbfb;
$pink: #ff65d2;
$orange: #ff5101;
$yellow: #fff200;
$green: #5eeda1;
$blue: #002eff;
$dark: #2e2f35;
$black: #00020b;

/* Global */

::-webkit-scrollbar {
  width: 0;
}

.no-scroll {
  @apply overflow-hidden h-full bg-none;
}

html,
body {
  @apply font-geist pb-0 leading-[1.25];
  scroll-behavior: smooth;
  scrollbar-width: none;
  font-feature-settings:
    'dlig' 1,
    'ss04' 1;
  font-family:
    'Geist',
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    'Helvetica Neue',
    Arial,
    sans-serif;
  background-color: var(--theme-background);
  color: var(--theme-text);
}

h1,
h2,
h3,
h4,
h5,
h6 {
  color: var(--theme-text);
  @apply tracking-normal leading-[130%] font-polymath;
}

h1,
.h1 {
  @apply text-md md:text-xl lg:text-3xl font-polymath font-medium;

  .emphasis {
    @apply font-semibold;
    font-feature-settings:
      'dlig' 1,
      'ss04' 1;
  }
}

.article-title h1 {
  @apply leading-[115%];
}

h2,
.h2 {
  @apply text-lg lg:text-xl font-polymath font-medium;

  .emphasis {
    @apply font-medium;
    font-feature-settings:
      'dlig' 1,
      'ss04' 1;
  }
}

h2.paragraph {
  @apply mt-3 mb-4;
}

.article-container h2 span {
  @apply text-black/50 block mb-4;
}

h3,
.h3 {
  @apply text-md lg:text-lg font-polymath font-medium;
}

h4,
.subhead {
  @apply text-xs font-width-expanded tracking-widest uppercase font-polymath font-semibold;
}

h5 {
  @apply text-sm font-width-expanded uppercase tracking-wide font-polymath font-medium;
}

.subhead {
  &.small {
    @apply text-xs;
  }
}

p,
ul,
ol,
blockquote,
label,
input,
.product-desc,
.paragraph,
.newsletter-bonus-container,
.bonus-container {
  color: var(--theme-text);
  @apply mb-0 text-base tracking-normal font-normal font-geist;

  a {
    @apply inline no-underline text-black duration-duration-fast ease-in-out font-medium;

    background:
      linear-gradient(transparent, transparent),
      linear-gradient(to right, rgba($black, 0.15), rgba($black, 0.15)),
      linear-gradient(to right, $black, $black);
    background-size:
      30px 2px,
      100% 2px,
      0 2px;
    background-position:
      calc(30px * -1) 100%,
      100% 100%,
      0 100%;
    background-repeat: no-repeat;

    &:hover {
      @apply no-underline text-black;
      background-size:
        30px 2px,
        0 2px,
        100% 2px;
      background-position:
        calc(100% + 30px) 100%,
        100% 100%,
        0 100%;
    }
  }

  a.alt-link {
    @apply inline no-underline text-white duration-duration-fast ease-in-out font-medium;

    background:
      linear-gradient(transparent, transparent),
      linear-gradient(to right, rgba($white, 0.15), rgba($white, 0.15)),
      linear-gradient(to right, $white, $white);
    background-size:
      30px 2px,
      100% 2px,
      0 2px;
    background-position:
      calc(30px * -1) 100%,
      100% 100%,
      0 100%;
    background-repeat: no-repeat;

    &:hover {
      @apply no-underline text-white;
      background-size:
        30px 2px,
        0 2px,
        100% 2px;
      background-position:
        calc(100% + 30px) 100%,
        100% 100%,
        0 100%;
    }
  }

  em,
  i {
    @apply font-geist;
    font-style: italic;
  }
}

a {
  @apply transition-all duration-duration-fast ease-in-out;
}

ul {
  @apply list-disc;
}

ul.checkmarks {
  @apply ml-0 leading-[150%] list-none;

  li {
    background-image: url("data:image/svg+xml,%3Csvg width='18px' height='18px' viewBox='0 0 24 24' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3Eicon-check%3C/title%3E%3Cg id='icon-check' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg%3E%3Ccircle id='Oval' fill='%230c0e10' cx='12' cy='12' r='12'%3E%3C/circle%3E%3Cpolyline id='Path' stroke='%23F9F9F9' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round' points='16.6666667 9 10.0394477 16 7.33333333 13.2020979'%3E%3C/polyline%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    @apply pl-7 bg-no-repeat bg-[length:1.125rem_1.125rem] bg-[0%_0.125rem] lg:bg-[0%_0.225rem];
  }
}

ol {
  @apply list-decimal;
}

li {
  @apply ml-0 mb-2.5;
  font-size: inherit;
}

em,
i {
  @apply font-geist;
  font-style: italic;
}

strong {
  @apply text-black/100 font-medium;
}

/* Animations */

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

.fade-in {
  animation: fadeIn 100ms ease-out forwards;
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }

  to {
    opacity: 0;
  }
}

.fade-out {
  animation: fadeOut 100ms ease-out forwards;
}

@keyframes spinAndPulse {
  0% {
    transform: rotate(0deg) scale(1.75);
  }

  50% {
    transform: rotate(180deg) scale(3.5);
  }

  100% {
    transform: rotate(360deg) scale(1.75);
  }
}

.animate-spin-pulse {
  animation: spinAndPulse 100s infinite;
}

@keyframes spin {
  from {
    transform: translate3d(0, 0, 0) rotate(0deg);
  }

  to {
    transform: translate3d(0, 0, 0) rotate(360deg);
  }
}

.spin-animation {
  animation: spin 2s linear infinite;
  animation-play-state: paused;
}

.spin-animation.playing {
  animation-play-state: running;
}

/* CD Spinner Classes - Optimized with containment */
.cd-spinner {
  contain: layout style paint size; /* Full CSS containment for maximum performance */
  will-change: transform; /* Only transform, not filter */
  backface-visibility: hidden;
  transform-style: preserve-3d;
  transform: translateZ(0); /* Force GPU layer */
  /* Additional performance optimizations for fast rotation */
  pointer-events: none; /* No interaction needed */
  -webkit-transform: translateZ(0); /* Webkit GPU acceleration */
  -webkit-backface-visibility: hidden;
  -webkit-perspective: 1000;
}

.cd-spinner.cd-spinning {
  animation: cd-spin-optimized 0.17s linear infinite; /* Realistic CD speed ~350 RPM */
  opacity: 0.85; /* Slight transparency suggests motion blur without expensive filter */
}

.cd-spinner.cd-paused {
  animation-play-state: paused;
  opacity: 1; /* Full opacity when stopped */
}

@keyframes cd-spin-optimized {
  from { 
    transform: translateZ(0) rotate(0deg);
  }
  to { 
    transform: translateZ(0) rotate(360deg);
  }
}

.cd-spinner.cd-spinning {
  animation-play-state: running;
}

.cd-spinner.cd-paused {
  animation-play-state: paused;
}

/* Loading animation */
@keyframes loadingSpin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: loadingSpin 2s linear infinite;
}

/* Marquee styles */
.marquee {
  width: 100%;
  overflow: hidden;
  white-space: nowrap;
  box-sizing: border-box;
  position: relative;
  text-align: left;
  padding-left: 15%;
}

.marquee-content {
  display: inline-block;
  white-space: nowrap;
  animation: marquee 10s linear infinite;
  animation-play-state: paused;
  position: relative;
  padding-right: 15%;
}

.marquee-gradient {
  -webkit-mask-image: linear-gradient(
    to right,
    transparent,
    black 15%,
    black 85%,
    transparent 100%
  );
  mask-image: linear-gradient(to right, transparent, black 15%, black 85%, transparent 100%);
}

@keyframes marquee {
  0% {
    transform: translateX(0);
  }

  100% {
    transform: translateX(calc(-100% - 20px));
  }
}

/* Sunset theme animations */
@keyframes shimmer {
  0%, 100% {
    transform: translateX(-10px) translateY(-5px);
    opacity: 0.3;
  }
  50% {
    transform: translateX(10px) translateY(5px);
    opacity: 0.7;
  }
}

@keyframes rotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes float0 {
  0%, 100% {
    transform: translateY(0px) translateX(0px);
    opacity: 0.4;
  }
  25% {
    transform: translateY(-20px) translateX(10px);
    opacity: 0.8;
  }
  50% {
    transform: translateY(-10px) translateX(-5px);
    opacity: 0.6;
  }
  75% {
    transform: translateY(-30px) translateX(15px);
    opacity: 0.9;
  }
}

@keyframes float1 {
  0%, 100% {
    transform: translateY(0px) translateX(0px);
    opacity: 0.3;
  }
  33% {
    transform: translateY(-25px) translateX(-10px);
    opacity: 0.7;
  }
  66% {
    transform: translateY(-15px) translateX(8px);
    opacity: 0.8;
  }
}

@keyframes float2 {
  0%, 100% {
    transform: translateY(0px) translateX(0px);
    opacity: 0.5;
  }
  40% {
    transform: translateY(-18px) translateX(-12px);
    opacity: 0.9;
  }
  80% {
    transform: translateY(-8px) translateX(6px);
    opacity: 0.4;
  }
}

.marquee-content::before,
.marquee-content::after {
  content: attr(data-text);
  position: absolute;
  white-space: nowrap;
  padding-right: 15%;
}

.marquee-content::before {
  left: calc(100% + 20px);
}

.marquee-content::after {
  left: calc(200% + 20px);
}

.no-marquee {
  text-align: center;
  padding: 0 15px;
}

.no-marquee-content {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Volume Slider Styles */
.volume-slider {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
  width: 100%;
  height: 3px;
  position: relative;
  margin: 0;
  padding: 0;
}

.volume-slider::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--volume-slider-track-color, rgba(255, 255, 255, 0.1));
  border-radius: 9999px;
}

.volume-slider::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: var(--volume-percentage, 0%);
  height: 100%;
  background: var(--volume-slider-color, white);
  border-radius: 9999px;
  transform-origin: left;
  transition: width 300ms cubic-bezier(0.4, 0, 0.2, 1);
  will-change: width;
}

.volume-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  height: 3px;
  width: 0;
  background: transparent;
  cursor: pointer;
  position: relative;
}

.volume-slider::-moz-range-thumb {
  appearance: none;
  height: 3px;
  width: 0;
  border: 0;
  background: transparent;
  cursor: pointer;
  position: relative;
}

.volume-slider::-webkit-slider-runnable-track {
  background: transparent;
  border-radius: 9999px;
  height: 3px;
}

.volume-slider::-moz-range-track {
  background: transparent;
  border-radius: 9999px;
  height: 3px;
}

.volume-slider:focus {
  outline: none;
}

.volume-slider:focus::after {
  opacity: 0.9;
}

/* Playback Controls */
.playback-controls {
  display: inline-flex;
  align-items: center;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border-radius: 9999px;
  padding: 0.5rem;
  gap: 0.75rem;
}

.control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  border-radius: 9999px;
  padding: 0.75rem;
}

.control-button:hover {
  transform: scale(1.05);
}

.control-button:active {
  transform: scale(0.95);
}

.control-button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
}

/* Theme-Specific Enhancements */

/* Neon theme glow effects */
.theme-neon {
  .volume-slider::after {
    box-shadow: 0 0 8px var(--theme-accent);
  }
  
  .control-button:hover {
    box-shadow: 0 0 12px var(--theme-accent);
  }
}

/* Ocean theme subtle animations */
.theme-ocean {
  .spin-animation.playing {
    animation: spin var(--theme-vinylSpeed) ease-in-out infinite;
  }
}

/* Sunset theme warm glow */
.theme-sunset {
  .cd-spinner.cd-spinning {
    filter: drop-shadow(0 0 4px var(--theme-secondary));
  }
}

/* Light theme softer shadows */
.theme-light {
  .control-button {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }
}

/* Dark theme enhanced contrast */
.theme-dark {
  .volume-slider::before {
    background: rgba(255, 255, 255, 0.15);
  }
}

/* Vaporwave font override - applies to all elements */
.vaporwave-font,
.vaporwave-font * {
  font-family: 'Silkscreen', 'Geist', monospace !important;
}

/* CRT Screen Jitter Animations for Vaporwave */
@keyframes crt-flicker {
  0% { opacity: 1; }
  98% { opacity: 1; }
  99% { opacity: 0.95; }
  100% { opacity: 1; }
}

@keyframes crt-jitter {
  0% { transform: translateY(0px); }
  10% { transform: translateY(-0.5px); }
  20% { transform: translateY(0.5px); }
  30% { transform: translateY(-0.2px); }
  40% { transform: translateY(0.3px); }
  50% { transform: translateY(-0.1px); }
  60% { transform: translateY(0.2px); }
  70% { transform: translateY(-0.3px); }
  80% { transform: translateY(0.1px); }
  90% { transform: translateY(-0.4px); }
  100% { transform: translateY(0px); }
}

@keyframes scan-line-move {
  0% { transform: translateY(-100vh); }
  100% { transform: translateY(100vh); }
}

@keyframes vhs-tracking {
  0% { transform: translateX(0px); }
  2% { transform: translateX(-2px); }
  4% { transform: translateX(1px); }
  6% { transform: translateX(0px); }
  92% { transform: translateX(0px); }
  94% { transform: translateX(3px); }
  96% { transform: translateX(-1px); }
  100% { transform: translateX(0px); }
}

@keyframes rgb-split {
  0% { transform: translateX(0px); filter: hue-rotate(0deg); }
  10% { transform: translateX(2px); filter: hue-rotate(90deg); }
  20% { transform: translateX(-1px); filter: hue-rotate(180deg); }
  30% { transform: translateX(0px); filter: hue-rotate(270deg); }
  100% { transform: translateX(0px); filter: hue-rotate(360deg); }
}

@keyframes grid-perspective {
  0% { transform: perspective(800px) rotateX(75deg) translateZ(-100px) translateY(0px); }
  100% { transform: perspective(800px) rotateX(75deg) translateZ(-100px) translateY(40px); }
}

@keyframes grid-travel {
  0% { 
    background-position: 0px 100vh, 0px 100vh;
    transform: perspective(600px) rotateX(80deg) translateY(20px);
  }
  100% { 
    background-position: 0px 60vh, 0px 60vh;
    transform: perspective(600px) rotateX(80deg) translateY(20px);
  }
}

@keyframes tron-grid-travel {
  0% { 
    background-position: 50px 50px, 50px 50px;
  }
  100% { 
    background-position: 0px 0px, 0px 0px;
  }
}

@keyframes tron-grid-subtle-flow {
  0% { 
    background-position: 0px 50px, 0px 50px;
  }
  100% { 
    background-position: 0px 0px, 0px 0px;
  }
}

@keyframes float-kanji {
  0% { 
    transform: translateY(100vh) translateX(0px);
    opacity: 0;
  }
  10% { opacity: 0.7; }
  90% { opacity: 0.7; }
  100% { 
    transform: translateY(-10vh) translateX(50px);
    opacity: 0;
  }
}

@keyframes datamosh {
  0% { 
    transform: translateX(0px) scale(1, 1);
    filter: hue-rotate(0deg);
  }
  25% { 
    transform: translateX(2px) scale(1.01, 0.98);
    filter: hue-rotate(90deg);
  }
  50% { 
    transform: translateX(-1px) scale(0.99, 1.02);
    filter: hue-rotate(180deg);
  }
  75% { 
    transform: translateX(3px) scale(1.02, 0.97);
    filter: hue-rotate(270deg);
  }
  100% { 
    transform: translateX(0px) scale(1, 1);
    filter: hue-rotate(360deg);
  }
}
